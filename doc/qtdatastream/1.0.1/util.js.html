<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>util.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-qtdatastream_buffer.ReadBuffer.html">ReadBuffer</a></li><li><a href="module-qtdatastream_socket.Socket.html">Socket</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_socket.Socket.html#detachSocket">detachSocket</a></li><li data-type='method'><a href="module-qtdatastream_socket.Socket.html#setSocket">setSocket</a></li><li data-type='method'><a href="module-qtdatastream_socket.Socket.html#updateSocket">updateSocket</a></li><li data-type='method'><a href="module-qtdatastream_socket.Socket.html#write">write</a></li></ul></li><li><a href="module-qtdatastream_transform.ReadTransform.html">ReadTransform</a></li><li><a href="module-qtdatastream_transform.WriteTransform.html">WriteTransform</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_transform.WriteTransform.html#.getBuffer">getBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QBool.html">QBool</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QBool.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QBool.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QByteArray.html">QByteArray</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QByteArray.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QByteArray.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QChar.html">QChar</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QChar.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QChar.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QClass.html">QClass</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QClass.html#.from">from</a></li></ul></li><li><a href="module-qtdatastream_types.QDateTime.html">QDateTime</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QDateTime.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QDateTime.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QDouble.html">QDouble</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QDouble.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QDouble.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QInt.html">QInt</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QInt.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QInt.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QInt64.html">QInt64</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QInt64.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QInt64.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QInvalid.html">QInvalid</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QInvalid.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QInvalid.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QList.html">QList</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QList.html#.of">of</a></li><li data-type='method'><a href="module-qtdatastream_types.QList.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QList.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QMap.html">QMap</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QMap.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QMap.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QShort.html">QShort</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QShort.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QShort.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QString.html">QString</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QString.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QString.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QStringList.html">QStringList</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QStringList.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QStringList.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QTime.html">QTime</a></li><li><a href="module-qtdatastream_types.QUInt.html">QUInt</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QUInt.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QUInt.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QUInt64.html">QUInt64</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QUInt64.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QUInt64.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QUserType.html">QUserType</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QUserType.html#.createComplexUserType">createComplexUserType</a></li><li data-type='method'><a href="module-qtdatastream_types.QUserType.html#.createUserType">createUserType</a></li><li data-type='method'><a href="module-qtdatastream_types.QUserType.html#.get">get</a></li><li data-type='method'><a href="module-qtdatastream_types.QUserType.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QUserType.html#.register">register</a></li><li data-type='method'><a href="module-qtdatastream_types.QUserType.html#~toBuffer">toBuffer</a></li></ul></li><li><a href="module-qtdatastream_types.QVariant.html">QVariant</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.QVariant.html#.coerceNumbersTo">coerceNumbersTo</a></li><li data-type='method'><a href="module-qtdatastream_types.QVariant.html#.read">read</a></li><li data-type='method'><a href="module-qtdatastream_types.QVariant.html#~toBuffer">toBuffer</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-qtdatastream_buffer.html">qtdatastream/buffer</a></li><li><a href="module-qtdatastream_serialization.html">qtdatastream/serialization</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_serialization.html#.Serializable">Serializable</a></li><li data-type='method'><a href="module-qtdatastream_serialization.html#.serialize">serialize</a></li></ul></li><li><a href="module-qtdatastream_socket.html">qtdatastream/socket</a></li><li><a href="module-qtdatastream_transform.html">qtdatastream/transform</a></li><li><a href="module-qtdatastream_types.html">qtdatastream/types</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_types.html#~qtype">qtype</a></li></ul></li><li><a href="module-qtdatastream_util.html">qtdatastream/util</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_util.html#.dateToJulianDay">dateToJulianDay</a></li><li data-type='method'><a href="module-qtdatastream_util.html#.julianDayToDate">julianDayToDate</a></li><li data-type='method'><a href="module-qtdatastream_util.html#.str">str</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="ReadTransform.html#event:data">data</a></li><li><a href="WriteTransform.html#event:data">data</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">util.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * node-qtdatastream
 * https://github.com/magne4000/node-qtdatastream
 *
 * Copyright (c) 2017 JoÃ«l Charles
 * Licensed under the MIT license.
 */

/** @module qtdatastream/util */

/**
 * Apply `toString()` method on Buffer and remove NUL end char
 * @static
 * @param {Buffer} obj
 * @returns {string}
 */
function str(obj) {
  const str = obj.toString();
  return str.replace('\0', '');
}

/**
 * Convert a Date object to a Julian day representation
 * @static
 * @param {Date} d
 * @returns {number}
 */
function dateToJulianDay(d) {
  const year = d.getFullYear();
  const month = d.getMonth() + 1;
  const day = d.getDate();
  const a = Math.floor((14-month)/12);
  const y = Math.floor(year+4800-a);
  const m = month+12*a-3;
  const jdn = day + Math.floor((153*m+2)/5)+(365*y)+Math.floor(y/4)-Math.floor(y/100)+Math.floor(y/400)-32045;
  return jdn;
}

/**
 * Convert a Julian day representation to a Date object
 * @static
 * @param {number} i
 * @returns {Date}
 */
function julianDayToDate(i) {
  const y = 4716;
  const v = 3;
  const j = 1401;
  const u = 5;
  const m = 2;
  const s = 153;
  const n = 12;
  const w = 2;
  const r = 4;
  const B = 274277;
  const p = 1461;
  const C = -38;
  const f = i + j + Math.floor((Math.floor((4 * i + B) / 146097) * 3) / 4) + C;
  const e = r * f + v;
  const g = Math.floor((e % p) / r);
  const h = u * g + w;
  const D = Math.floor((h % s) / u) + 1;
  const M = ((Math.floor(h / s) + m) % n) + 1;
  const Y = Math.floor(e / p) - y + Math.floor((n + m - M) / n);
  return new Date(Y, M-1, D);
}

module.exports = {
  str,
  dateToJulianDay,
  julianDayToDate
};
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Mar 04 2018 23:02:40 GMT+0100 (CET) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
